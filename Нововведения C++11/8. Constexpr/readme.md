# Constexpr

Constexpr (constant expression) - это ключевое слово, используемое в языке программирования C++. С помощью этого спецификатора можно создавать переменные, функции и объекты и выполнить расчёты на этапе компиляции, вместо того чтобы делать это во время выполнения.

Синтаксис: 


`constexpr тип = expression` // expression должно быть известно на этапе компиляции


`constexpr double pi = 3.14159265;` // значение переменной будет вычислено на этапе компиляции

Плюсы:

- часть вычислений можно переложить на компиляцию (этап компиляции будет долгим, зато запуск быстрым)

Минусы:

- невозможно дебажить такие выражения
  
- много ограничений (чтобы это сработало нужно соблюсти большое количество условий)

## Обязательные условия использовния constexpr

1. Для того чтобы функция могла быть вычислена на этапе компиляции, необходимо добавить к ней спецификатор constexpr перед сигнатурой функции.
А также в точке вызова нужно прописать constexpr.

Рассмотрим первый пример:

`constexpr int sum (int v1, int v2) {`


`return v1 + v2;`


`}`


`constexpr int val = sum (5, 12);`

Данный код использует функцию `sum` для вычисления суммы двух чисел `v1` и `v2`. Функция `sum` объявлена как `constexpr`, что означает, что она может быть вычислена на этапе компиляции. Функция возвращает сумму `v1` и `v2`.

Далее в коде объявляется переменная `constexpr val` и инициализируется результатом вызова функции `sum` с аргументами 5 и 12. Так как вызов функции sum происходит на этапе компиляции, переменная `val` будет вычислена на этапе компиляции.

Таким образом, переменная `val` будет иметь значение 17, так как 5 + 12 = 17.


Рассмотрим второй пример:

`int new_sum (int v1, int v2){


`return v1 + v2;`

 
`}`


`constexpr int val_new = new_sum(4, 5)`

Здесь к функции не добавлен спецификатор `constexpr`. Вычислить её не удастся.


2. Тип данных, используемый в `constexpr` контексте, должен быть литеральным типом. Литеральные типы данных включают в себя скалярные типы (например, `int`, `floa`t, `double`), указатели и массивы скалярных типов.
  
3. Должно быть сразу присвоено значение или вызыван `constexpr` конструктор
  
4. `Constexpr` функция не может быть вирутальной
   
5. `Constexpr` функция должна возвращать литеральный тип (В С++14 можно вернуть `void`)

   
6. Все входные параметры `constexpr` функции должны иметь литеральный тип

   
7. Тело функции должно содержать ровно один `return`, который может содержать литералы или `constexpr` функции.

